@model PagedList.IPagedList<LetsTest.Models.ProductsList>
@using PagedList;
@using PagedList.Mvc;
@using LetsTest.Models;

<link href="~/Content/PagedList.css" rel="stylesheet" type="text/css" />
@{
    ViewBag.Title = "Household";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="w3l_banner_nav_right">
    <div class="w3ls_w3l_banner_nav_right_grid w3ls_w3l_banner_nav_right_grid_sub">
        <h3>Products</h3>
        <div class="" style="display:flex;flex-direction:row;justify-content:space-between;align-items:center">
            <div class="d-inline">
                @using (Html.BeginForm("Productslist", "Products", FormMethod.Get))
                {
                    <b>Search By:</b> @Html.RadioButton("searchBy", "StoreName", true)<text>Store Name</text>
                    @Html.RadioButton("searchBy", "ProductName")<text>Product Name</text><br />
                    @Html.TextBox("Search")<input type="submit" value="Search" />
                }
            </div>
            <div class="dropdown d-inline">
                <button class="btn btn-primary dropdown-toggle" id="menu1" type="button" data-toggle="dropdown">
                    SortBy Price
                </button>
                <ul class="dropdown-menu" role="menu" aria-labelledby="menu1">
                    <li>@Html.ActionLink("Price high to low", "Productslist", new { sort = ViewBag.SortPriceParameter, searchBy = Request.QueryString["searchBy"], Search = Request["Search"] })</li>
                    <li>@Html.ActionLink("Price low to high", "Productslist", new { sort = ViewBag.SortPriceParameter, searchBy = Request.QueryString["searchBy"], Search = Request["Search"] })</li>
                </ul>
            </div>
        </div>
       
        @if (Model.Count() == 0)
        {
            <h4>Nothing found to your search criteria.</h4>
        }
        else
        {
            <div class="w3ls_w3l_banner_nav_right_grid1"  style="padding:60px">
                @foreach (var prod in Model)
                {
                    <div class="col-md-3 w3ls_w3l_banner_left"  >
                        <div class="hover14 column">
                            <div class="agile_top_brand_left_grid w3l_agile_top_brand_left_grid">
                                <div class="agile_top_brand_left_grid_pos">
                                    <img src="~/images/offer.png" alt=" " class="img-responsive" />
                                </div>
                                <div class="agile_top_brand_left_grid1">
                                    <figure>
                                        <div class="snipcart-item block">
                                            <div id="prod" class="snipcart-thumb">
                                                <a href="~/Single/SingleProduct/@prod.ID" value="@prod.ID" id="@prod.ID"><img src="@Url.Content(prod.IMAGE1)" alt=" " class="img-responsive img-resize" /></a>
                                                <p style="background-color:blueviolet; color:whitesmoke; border-radius:20px; text-align:center; width:75%; font-weight:400px; margin-left:25px">@prod.STORE</p>
                                                <p style="font-weight:bold; font-size: 1.0rem">@prod.NAME</p>
                                                @if ((prod.DISCOUNT != null && prod.START_DATE == DateTime.Now.Date) || (prod.SUBCATEGORY_DISCOUNT != null && prod.S_START_DATE == DateTime.Now.Date))
                                                {
                                                    if (prod.SUBCATEGORY_DISCOUNT != null)
                                                    {
                                                        prod.DISCOUNT = prod.SUBCATEGORY_DISCOUNT;
                                                    }

                                                    var data = prod.DISCOUNT;
                                                    prod.percentage = Convert.ToDecimal(data);
                                                    prod.DESC = (prod.percentage / 100) * (prod.PRICE);
                                                    prod.DESC_Price = (prod.PRICE) - (prod.DESC);
                                                    <h4 style="font-weight:bold; font-size: 1.0rem">Rs @prod.DESC_Price <span>Rs @prod.PRICE</span></h4>

                                                }
                                                else
                                                {
                                                    <h4 style="font-weight:bold; font-size: 1.0rem">Rs @prod.PRICE</h4>
                                                }
                                            </div>
                                            <div class="snipcart-details">
                                                <input type="button" name="AddToCart" value="Add to Cart" class="btn btn-primary" itemid="@prod.ID" id="btnAddToCart" onclick="AddToCart(this)" />
                                            </div>
                                        </div>
                                    </figure>
                                </div>
                            </div>
                        </div>
                    </div>
                }
                <div class="clearfix"> </div>
            </div>
        }
    </div>
    @Html.PagedListPager(Model, page => Url.Action("Productslist", "Products", new { page, searchBy = Request.QueryString["searchBy"], Search = Request.QueryString["Search"], sort = Request["sort"] }))
</div>
<div class="clearfix"></div>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $("#prod a").click(function () {
            $.ajax({
                type: "POST",
                url: '/Single/SingleProduct/' + this.id
            })
        })
    });
</script>
